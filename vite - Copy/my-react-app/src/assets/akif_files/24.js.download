"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[24],{478:(e,t,n)=>{n.d(t,{a:()=>o,b:()=>r});var a=n(0),i=n(54),r={unknown:"Unknown",spServiceResponse:"SPServiceResponse"},o=function(e){function t(n){var i=this,r=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,s=n.errorData||o||{status:0},c=s.message,d=void 0===c?void 0:c,l=s.correlationId,u=void 0===l?void 0:l,f=s.code,p=void 0===f?void 0:f,m=(0,a.__rest)(s,["message","correlationId","code"]),_="object"==typeof d?d?JSON.stringify(d):"".concat(d):d,h=r&&r.codes||{order:[],map:{}};if(o&&o.codes)for(var b=0,g=o.codes.order;b<g.length;b++){var v=g[b];h.map[v]||(h.order.push(v),h.map[v]=o.codes.map[v])}var y=(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},"string"==typeof u?{correlationId:u}:{}),"string"==typeof p?{code:p}:{}),"string"==typeof _?{message:_}:{}),n),{extraData:(0,a.__assign)((0,a.__assign)({},n.extraData||{}),{hasAuthChallenge:!!s.authenticate,status:s.status,infected:s.infected,groupThrottle:s.groupThrottle,statusText:s.statusText})});(i=e.call(this,y)||this).name="GetDataError",i.codes=h,i.errorData=s;for(var S=0,D=Object.keys(m);S<D.length;S++)i[v=D[S]]=m[v];return i}return(0,a.__extends)(t,e),t}(i.a)}
,624:(e,t,n)=>{n.d(t,{a:()=>V,b:()=>z});var a=n(0),i=n(23),r=n(1798),o=n(192),s=n(61),c=n(1799),d=n(16),l=n(305),u=n(54),f=n(89),p=n(503),m=n(478),_=n(1049),h=n(753),b=n(1191),g=n(2);function v(e){var t=e.options,n=t.url,r=t.authToken,o=t.telemetryHandler,s=t.useExactAuthToken,c=t.method,l=t.additionalHeaders,u=e.dataSyncClient,f=e.aadUserId,p=e.getData,m=function(){return p({url:n,telemetryHandler:o,authToken:r,useExactAuthToken:s})};return g.a.isActivated("26fb0edf-b3af-42db-b8ea-2858c7eacfe0")&&!f?m():i.c.resolve(u).then(function(e){return e?function(e){var t=function(e,t){return function(n,i,r){var o,s=n.eventData,c=s.extraData,l=void 0===c?{}:c,u={performanceEntry:l&&l.performanceEntry,httpStatus:l&&l.HttpStatus,responseHeaders:null===(o=n.serverData)||void 0===o?void 0:o.getResponseHeadersDictionary(),correlationId:l&&l.CorrelationId,succeeded:s&&s.resultType===d.b.Success||!1,resultCode:s&&s.resultCode,extraData:l},f=t&&t(n),p=g.a.isActivated("97E1912E-09BC-4111-9A67-EEA52ACC4BF3")?e.onRequestComplete(i,u):r(u);return l.dataSyncQos=e.getQosInfo(),(0,a.__assign)((0,a.__assign)({},f||{}),{eventData:(0,a.__assign)((0,a.__assign)({},f?f.eventData:s),{extraData:(0,a.__assign)((0,a.__assign)({},f?f.eventData.extraData:s.extraData),e.getQosInfo())}),canRetry:p&&(!f||f.canRetry)})}}(e,o);return e.getData({url:n,method:c,additionalHeaders:l},function(e){var n=e.endpoint,a=e.headers,i=e.onComplete;return p({url:n.url,authToken:n.authToken,telemetryHandler:function(e){return t(e,n,i)},useExactAuthToken:!0,additionalHeaders:a})},m)}(e):m()})}var y=n(176),S=n(38),D=n(135),I=n(434),x=g.a.isActivated("1A27D204-D190-440A-BD0E-C321879347A4");function C(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,s=e.tokenProvider,c=e.getData,d=e.qosName,l=t.url,p=new f.a(l),m="".concat(p.authority,"/{ length: ").concat(p.path.length,", segments: ").concat(p.segments.length," }"),_=function(e,t){if(!s.getAuthToken)return i.c.resolve({authToken:void 0});var n=new r({name:"".concat(d,".getAuthToken").concat(t?".retry":""),url:m});return i.c.resolve(s.getAuthToken(e)).then(function(e){return e&&"string"!=typeof e?(n.end({resultType:o.b.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}),e):(n.end({resultType:o.b.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"}),{authToken:e})}).catch(function(e){return n.end((0,D.a)(e)),i.c.reject(e)})},h=function(e,t){if(!s.getFormDigest)return i.c.resolve(void 0);var n=new r({name:"".concat(d,".getAuthToken").concat(t?".retry":""),url:m});return i.c.resolve(s.getFormDigest(e)).then(function(e){return n.end({resultType:o.b.Success,resultCode:e?"newDigest":"sameDigest"}),e}).catch(function(e){return n.end((0,D.a)(e)),i.c.reject(e)})};if(!_&&!h)return c({url:l});if(x&&n&&(g.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==l[0])&&!(0,I.a)(l,encodeURI(n)))throw new u.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});var b={url:l,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge},v={url:l,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge};return _(b,!1).then(function(e){return e.authToken?e:h(v,!1).then(function(t){return e})}).then(function(e){if(!x&&e.authToken&&n&&(g.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==l[0])&&!(0,I.a)(l,encodeURI(n)))throw new u.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});return c({url:l,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){var n;if(E(t))n={claimsChallenge:{authToken:e.authToken,claims:w(t),error:t}};else{if(!L(t)&&!A(t))return i.c.reject(t);n={expiration:{authToken:e.authToken,error:t}}}return _((0,a.__assign)((0,a.__assign)({},b),n),!0).then(function(n){if(!n.authToken){var r=void 0;if(E(t))r={claimsChallenge:{claims:w(t),error:t}};else{if(!L(t)&&!A(t))return i.c.reject(t);r={expiration:{error:t}}}return h((0,a.__assign)((0,a.__assign)({},v),r),!0).then(function(e){return n})}return n.authToken===e.authToken?i.c.reject(t):n}).then(function(e){return c({url:l,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}})}).catch(function(e){return i.c.reject(e)})})})}var O="Bearer";function w(e){var t=e.authenticate,n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return g.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}function E(e){var t=e.authenticate;return!!(t&&t.slice(0,O.length)===O&&t.indexOf('error="insufficient_claims"')>-1)}function A(e){return!!e.authenticate}function L(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var k=n(347),M=n(1167),P=n(177),T=g.a.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","07/12/2024","Disable collect sp perf metrics for Image tagging"),U="undefined"!=typeof window?window:void 0,F=U&&U.performance,H=function(){function e(e,t){var n,a,i,r,c,d,l,u,f,p;this._dataRequestorContext=t.dataRequestorContext,this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(a=this._dataRequestorContext)||void 0===a?void 0:a.tokenProvider,this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(r=this._dataRequestorContext)||void 0===r?void 0:r.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(c=null==t?void 0:t.apiEvent)&&void 0!==c?c:o.a,this._engagement=null!==(d=null==t?void 0:t.engagement)&&void 0!==d?d:s.a,this._normalizeErrors=null===(l=e.normalizeErrors)||void 0===l||l,this._getDataWithTokenProvider=null!==(u=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==u?u:C,this._getDataWithSyncClient=null!==(f=null==t?void 0:t.getDataWithSyncClient)&&void 0!==f?f:v,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null===(p=null==t?void 0:t.noRedirect)||void 0===p||p}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){var t=e.cancelToken,n=this._getData(e);if(t){var a=t.subscribe(function(){n.cancel()});return Promise.resolve(n).then(function(e){return a(),e}).catch(function(e){throw a(),e})}return Promise.resolve(n)},e.prototype._getData=function(t){var n=this,o=t.parseResponse,s=void 0===o?e.parseJSON:o,c=t.qosExtraData,l=t.additionalPostData,v=void 0===l?"":l,D=t.contentType,I=t.method,x=void 0===I?"POST":I,C=t.maxRetries,O=void 0===C?0:C,w=t.responseType,E=t.onUploadProgress,A=t.timeout,L=t.noTimeoutInLastRetry,H=void 0!==L&&L,R=t.webAbsoluteUrl,N=t.allowOAuth,B=void 0===N||N,j=t.customerPromise,V=t.url,z=t.maxUrlLength,G=void 0===z?2e3:z,K=t.onBeforeRequest;if(V.length>G)throw new m.a({errorData:{code:"".concat(M.a,",").concat(_.h),status:-1}});var W=this._dataRequestorContext,q=this._tokenProvider,Q=this._getDataWithTokenProvider,Y=this._getDataWithSyncClient,J=[];this._qosName&&J.push(this._qosName),t.qosName&&J.push(t.qosName);var X=J.join("."),Z=function(e){var o=e.url,l=e.telemetryHandler,I=e.authToken,C=e.useExactAuthToken,L=void 0!==C&&C,M=e.additionalHeaders,N=!0,V=new f.a(o),z="".concat(V.authority,"/{ length: ").concat(V.path.length,", segments: ").concat(V.segments.length," }"),G=function(e){var I=e.authToken,C=e.qosExtraData,V=t.crossSiteCollectionCall,G=void 0!==V&&V,Q=t.noRedirect,Y=void 0===Q?n._noRedirect:Q,J=t.needsRequestDigest,Z=void 0===J||J,$=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},t.additionalHeaders),M),T||"ODSDataSource.ODSP.ImageTag.Feedback.UploadImage"!==X?{CollectSPPerfMetrics:h.b.sqlQueryCount}:{});if(B&&I){var ee=!1;y.a.isFeatureEnabled({ECS:86137})||I.split(" ").length>1&&(ee=!0);var te=L||ee?I:"Bearer ".concat(I),ne=!1;for(var ae in $)ae&&"authorization"===ae.toLowerCase()&&(ne=!0);ne||($.Authorization=te),G=!0,Z=!1,Y=!0}else B&&S.d.isFeatureEnabled({ODB:60959})&&q&&($.Authorization="Bearer");var ie,re,oe=new b.a((0,a.__assign)((0,a.__assign)({},W?{webServerRelativeUrl:W.webServerRelativeUrl,webAbsoluteUrl:R||W.webAbsoluteUrl,alwaysGetDigest:G,formDigest:{serverTime:W.serverTime,updateFormDigestPageLoaded:W.updateFormDigestPageLoaded,formDigestValue:W.formDigestValue,formDigestTimeoutSeconds:W.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:Z,engagement:n._engagement,operationName:n._qosName})),se=U&&U.location&&new f.a(U.location.href).authority,ce=new f.a(o).authority;return null==K||K(),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,o=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.a(t,function(){n(c>=d||!o())});return a&&(!s||c<d)?i.a.timeout(a,e):e};return c<d?(0,r.a)({canRetry:o,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:A,onExecute:function(e,i){var r=function(t,r){return function(u){var f=u.getResponseText();re=u.getServiceWorkerDataSourceHeader();var _,b,g,v,y=(0,p.a)(o,r),S=(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},c||{}),{needsRequestDigest:Z,hasAuthToken:!!I,isCrossOrigin:!!se&&se!==ce,CorrelationId:u.getCorrelationId()}),C||{}),{HttpStatus:u.getStatus(),serviceWorkerDataSource:re||void 0,rawRequestDuration:y.duration,performanceEntry:JSON.stringify(y),serviceWorkerFetchInfo:u.getResponseHeader(h.b.serviceWorkerFetchInfo)||void 0,SQLRT:u.getHeaderNumberValue(h.b.sqlQueryCount),ServerDuration:u.getHeaderNumberValue(h.b.serverDuratrion)}),D=!1;try{!function(e,t){return"blob"===e&&!!t&&"object"==typeof t}(w,f)?b=s(f,u):g=f,D=!0}catch(e){_=e,v={resultType:d.b.Failure,resultCode:"InvalidJSON",error:(0,P.e)("object"==typeof e?JSON.stringify(e):e,!1),extraData:S}}if(v||(v={resultType:d.b.Success,extraData:S}),l&&(v=l({response:b,eventData:v,serverData:u}).eventData),null==t||t.end(v),D)try{e(g||b)}catch(e){}else i(n._normalizeErrors?new m.a({code:"-1,parse_response",innerError:_,errorData:{correlationId:u.getCorrelationId(),status:u.getStatus()}}):void 0);oe=void 0}},f=function(e,r){return function(s,f){var b=(0,p.a)(o,r),y=(0,a.__assign)((0,a.__assign)({},c||{}),{needsRequestDigest:Z,hasAuthToken:!!I,isCrossOrigin:!!se&&se!==ce,rawRequestDuration:b.duration,performanceEntry:JSON.stringify(b)}),S="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(S=n._offlineDetection.offline),!s){var D=_.g,x=!0,C=0;f&&f instanceof u.a&&(D=f.code,x=f.isExpected,C=-1),!S||D!==_.d&&D!==_.g||(D=_.e);var O={status:C,code:D},w={resultType:x?d.b.ExpectedFailure:d.b.Failure,resultCode:D,extraData:y};return l&&(w=l({eventData:w,errorData:O}).eventData),null==e||e.end(w),void i(n._normalizeErrors?new m.a({errorData:O,innerError:f}):O)}var E=function(r){var o=void 0,c=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(h.b.msDiagnostics);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:h.b.msDiagnostics,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(h.b.webDavExtError);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,b=p[2];c=void 0===b?"":b,u={source:h.b.webDavExtError,code:_,message:c,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}var g=e.getResponseHeader(h.b.spoErrorCode);if(g){var v=e.getResponseHeader(h.b.spoErrorMessage);u={source:h.b.spoErrorCode,code:g,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}var y=e.getResponseHeader(h.b.subStatusCode);return y&&(u={source:h.b.subStatusCode,code:y},n.order.push(u.source),n.map[u.source]=u),{codes:n,isExpected:t}}(s),u=null==c?void 0:c.isExpected,f=null==c?void 0:c.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var p=void 0;try{p=JSON.parse(r)}catch(e){}if(p)if(p.error_description)o={code:"-1,".concat(p.error||"Unknown"),message:p.error_description},"policy_enforced"===p.error&&(u=!0);else if("string"==typeof p.error)o={message:p.error};else if(p.error&&p.error.message&&p.error.message.value){var b={source:m.b.spServiceResponse,code:p.error.code,message:"".concat(p.error.message.value),isDisplayable:!0};f&&(f.order.push(b.source),f.map[b.source]=b),o=p.error}else o=p.error||p["odata.error"]||{responseData:p};else if(r&&400===s.getStatus()){var D;D=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:D},y=(0,a.__assign)((0,a.__assign)({},y),{rawUrl:t.url,rawPayload:v})}}var I=s.getStatus(),x=s.getCorrelationId(),C=s.getResponseHeader(h.b.spGroupThrottle),O=s.getResponseHeader(h.b.webDavExtError);if(y=(0,a.__assign)((0,a.__assign)({},y),{CorrelationId:x,HttpStatus:I,GroupThrottle:C,MSCorrelationVector:s.getResponseHeader(h.b.correlationVector)}),(401===I&&O||403===I||404===I||429===I||503===I||-1===I||0===I&&S)&&(N=!1,u=!0),400===I){var w=function(e){var t,n={order:[],map:{}},a="No X-Msedge-Ref details",i=e.getResponseHeader(h.b.msEdgeRef);return i?t={source:h.b.subStatusCode,code:"Non-Empty X-Msedge-Ref details",message:i}:g.a.isActivated("44F48045-1E39-41C1-962A-7F04F8093447")&&(t={source:h.b.subStatusCode,code:a,message:a}),t&&(n.order.push(t.source),n.map[t.source]=t),{codes:n,isExpected:!1}}(s);f&&w&&(Array.prototype.push.apply(f.order,w.codes.order),w.codes.order.forEach(function(e){f.map[e]=w.codes.map[e]})),y.rawUrl||y.rawPayload||(y=(0,a.__assign)((0,a.__assign)({},y),{rawUrl:t.url,rawPayload:v}))}(o=o||{}).codes=f,o.status=I,o.retryAfter=s.getHeaderNumberValue(h.b.retryAfter),o.authenticate=s.getResponseHeader(h.b.authenticate),o.authenticate&&(u=!0),x&&(o.correlationId=x),C&&(o.groupThrottle=C);var E=JSON.stringify(o);g.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(o.targetUrl=s.getSourceUrl());var A=o["@error.redirectUrl"],L=s.getRedirectUrl()||A;L&&(u=!0,o.redirectUrl=L);var k=null==f?void 0:f.map[m.b.spServiceResponse];k&&n._normalizeErrors&&(o.message=k.message);var M=null==f?void 0:f.order[0];M&&(b=f.map[M])&&(M===h.b.spoErrorCode&&b.message?(o.code=_.a,o.message=b.message):b.code&&(o.code=b.code)),o.code||(o.code=_.g);var T="[".concat(I,"] ").concat(o.code),U={resultType:u?d.b.ExpectedFailure:d.b.Failure,error:(0,P.e)(E,!1),resultCode:T,extraData:y};if(l){var F=l({eventData:U,errorData:o,serverData:s}),H=F.eventData,R=F.canRetry;H&&(U=H),!0!==R&&!1!==R||(N=R),U.resultType===d.b.ExpectedFailure&&(u=!0)}var B=n._normalizeErrors?new m.a({errorData:o,isExpected:u}):o;B.codes&&B.codes&&(U.extraData||(U.extraData={}),U.extraData.errorCodes=JSON.stringify(B.codes.map)),null==e||e.end(U),i(B)},A=s.getResponseType();A&&"text"!==A?s.parseError().then(E):E(s.getResponseText())}};!function(){var e;e=ie=j?new((0,k.a)(n._apiEvent))({url:z,name:X,pillar:(null==j?void 0:j.pillar)?j.pillar:void 0,veto:(null==j?void 0:j.veto)?j.veto:void 0}):new n._apiEvent({url:z,name:X});var t=F&&F.now();oe.getServerDataFromUrl({url:o,successCallback:r(e,t),failureCallback:f(e,t),uploadProgressCallback:E,additionalPostData:v,method:x,additionalHeaders:$,contentType:D,withCredentials:!I&&void 0,noRedirect:Y,responseType:w,needsRequestDigest:Z})}()},maxRetries:O,noTimeoutInLastRetry:H,canRetry:function(){return N},onCancel:function(e){oe&&(oe.abort(),e&&oe.dispose())}}).then(function(e){return oe&&oe.dispose(),e},function(e){return oe&&oe.dispose(),!ie.endTime&&i.a.isCanceled(e)&&ie.end({resultCode:_.b,resultType:d.b.ExpectedFailure}),i.a.reject(e)})};return I?i.a.resolve(I).then(function(e){return G({url:o,authToken:e})}):(null==W?void 0:W.authToken)?i.a.resolve(W.authToken).then(function(e){return G({url:o,authToken:e})}):q?null==Q?void 0:Q({apiEvent:n._apiEvent,getData:G,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:R||W&&W.webAbsoluteUrl,qosName:X,tokenProvider:q}):(null==W?void 0:W.getAuthToken)?i.a.resolve(W.getAuthToken()).then(function(e){return G({url:o,authToken:e})}):G({url:o})},$={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?null==Y?void 0:Y({options:$,aadUserId:null==W?void 0:W.aadUserId,dataSyncClient:this._dataSyncClient,getData:Z}):Z($)},e}(),R=n(69),N=g.a.isActivated("cb77018d-603a-46a1-8ddf-5a8f4e2fee2f"),B="undefined"!=typeof window?window:void 0,j=B&&B.performance,V=function(){function e(e,t){var n,i,r,c,d,l,u,f,p,m;if(N)this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=null!==(i=null==t?void 0:t.tokenProvider)&&void 0!==i?i:null===(r=this._pageContext)||void 0===r?void 0:r.tokenProvider,this._dataSyncClient=null!==(c=null==t?void 0:t.dataSyncClient)&&void 0!==c?c:null===(d=this._pageContext)||void 0===d?void 0:d.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(l=null==t?void 0:t.apiEvent)&&void 0!==l?l:o.a,this._engagement=null!==(u=null==t?void 0:t.engagement)&&void 0!==u?u:s.a,this._normalizeErrors=!!e.normalizeErrors,this._getDataWithTokenProvider=null!==(f=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==f?f:C,this._getDataWithSyncClient=null!==(p=null==t?void 0:t.getDataWithSyncClient)&&void 0!==p?p:v,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null!==(m=null==t?void 0:t.noRedirect)&&void 0!==m?m:!!(null==t?void 0:t.tokenProvider)||void 0;else{var _=t?t.pageContext:e.pageContext;this._dataRequestorNew=new H((0,a.__assign)((0,a.__assign)({},e),{normalizeErrors:!!e.normalizeErrors}),(0,a.__assign)((0,a.__assign)({},t||{}),{dataRequestorContext:_,noRedirect:null!==(n=null==t?void 0:t.noRedirect)&&void 0!==n?n:!!(null==t?void 0:t.tokenProvider)}))}}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){if(void 0!==this._dataRequestorNew){var t,n,r=function(){e.onBeforeRequest&&e.onBeforeRequest();var t=l.b.getRUMOneLogger(),n=Date.now();t&&(t.readTempData("appDataFetchStart")||t.saveTempData("appDataFetchStart",n))};if(e.cancelToken)return i.c.resolve(this._dataRequestorNew.getData((0,a.__assign)((0,a.__assign)({},e),{onBeforeRequest:r})));var o=new R.b;return this._dataRequestorNew.getData((0,a.__assign)((0,a.__assign)({},e),{onBeforeRequest:r,cancelToken:o.token})).then(function(e){null==t||t(e),null==o||o.dispose()}).catch(function(e){null==n||n(e),null==o||o.dispose()}),new i.c(function(e,a){t=e,n=a},function(){o.cancel()})}var s=this._oldGetData(e);return e.cancelToken?i.c.resolve((0,c.a)(s,e.cancelToken)):s},e.prototype._oldGetData=function(t){var n=this,o=t.parseResponse,s=void 0===o?e.parseJSON:o,c=t.qosExtraData,v=t.additionalPostData,D=void 0===v?"":v,I=t.contentType,x=t.method,C=void 0===x?"POST":x,O=t.maxRetries,w=void 0===O?0:O,E=t.responseType,A=t.onUploadProgress,L=t.timeout,P=t.noTimeoutInLastRetry,T=void 0!==P&&P,U=t.webAbsoluteUrl,F=t.allowOAuth,H=void 0===F||F,R=t.customerPromise,N=t.url,V=t.maxUrlLength,z=void 0===V?2e3:V;if(N.length>z)throw new m.a({errorData:{code:"".concat(M.a,",").concat(_.h),status:-1}});var G=this._pageContext,K=this._tokenProvider,W=this._getDataWithTokenProvider,q=this._getDataWithSyncClient,Q=[];this._qosName&&Q.push(this._qosName),t.qosName&&Q.push(t.qosName);var Y=Q.join("."),J=function(e){var o=e.url,v=e.telemetryHandler,x=e.authToken,O=e.useExactAuthToken,M=void 0!==O&&O,P=e.additionalHeaders,F=!0,N=new f.a(o),V="".concat(N.authority,"/{ length: ").concat(N.path.length,", segments: ").concat(N.segments.length," }"),z=function(e){var x=e.authToken,O=e.qosExtraData,N=t.crossSiteCollectionCall,z=void 0!==N&&N,W=t.noRedirect,q=void 0===W?n._noRedirect:W,Q=t.needsRequestDigest,J=void 0===Q||Q,X=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},t.additionalHeaders),P),{CollectSPPerfMetrics:h.b.sqlQueryCount});if(H&&x){var Z=!1;y.a.isFeatureEnabled({ECS:86137})||x.split(" ").length>1&&(Z=!0);var $=M||Z?x:"Bearer ".concat(x),ee=!1;for(var te in X)te&&"authorization"===te.toLowerCase()&&(ee=!0);ee||(X.Authorization=$),z=!0,J=!1,q=!0}else H&&S.d.isFeatureEnabled({ODB:60959})&&K&&(X.Authorization="Bearer");var ne,ae,ie=new b.a((0,a.__assign)((0,a.__assign)({},G?{webServerRelativeUrl:G.webServerRelativeUrl,webAbsoluteUrl:U||G.webAbsoluteUrl,alwaysGetDigest:z,formDigest:{serverTime:G.serverTime,updateFormDigestPageLoaded:G.updateFormDigestPageLoaded,formDigestValue:G.formDigestValue,formDigestTimeoutSeconds:G.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:J,engagement:n._engagement,operationName:n._qosName})),re=B&&B.location&&new f.a(B.location.href).authority,oe=new f.a(o).authority,se=l.b.getRUMOneLogger(),ce=Date.now();return se&&(se.readTempData("appDataFetchStart")||se.saveTempData("appDataFetchStart",ce)),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,o=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.c(t,function(){n(c>=d||!o())});return a&&(!s||c<d)?i.c.timeout(a,e):e};return c<d?(0,r.a)({canRetry:o,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:L,onExecute:function(e,i){var r=function(t,r){return function(l){var u=l.getResponseText();ae=l.getServiceWorkerDataSourceHeader();var f,_,b,g,y=(0,p.a)(o,r),S=(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},c||{}),{needsRequestDigest:J,hasAuthToken:!!x,isCrossOrigin:!!re&&re!==oe,CorrelationId:l.getCorrelationId()}),O||{}),{HttpStatus:l.getStatus(),serviceWorkerDataSource:ae||void 0,rawRequestDuration:y.duration,performanceEntry:JSON.stringify(y),serviceWorkerFetchInfo:l.getResponseHeader(h.b.serviceWorkerFetchInfo)||void 0,SQLRT:l.getHeaderNumberValue(h.b.sqlQueryCount),ServerDuration:l.getHeaderNumberValue(h.b.serverDuratrion)}),D=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(E,u)?_=s(u,l):b=u,D=!0}catch(e){f=e,g={resultType:d.b.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:S}}if(g||(g={resultType:d.b.Success,extraData:S}),v&&(g=v({response:_,eventData:g,serverData:l}).eventData),t.end(g),D)try{e(b||_)}catch(e){}else i(n._normalizeErrors?new m.a({code:"-1,parse_response",innerError:f,errorData:{correlationId:l.getCorrelationId(),status:l.getStatus()}}):void 0);ie=void 0}},l=function(e,r){return function(s,l){var f=(0,p.a)(o,r),b=(0,a.__assign)((0,a.__assign)({},c||{}),{needsRequestDigest:J,hasAuthToken:!!x,isCrossOrigin:!!re&&re!==oe,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}),y="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(y=n._offlineDetection.offline),!s){var S=_.g,I=!0,C=0;l&&l instanceof u.a&&(S=l.code,I=l.isExpected,C=-1),!y||S!==_.d&&S!==_.g||(S=_.e);var O={status:C,code:S},w={resultType:I?d.b.ExpectedFailure:d.b.Failure,resultCode:S,extraData:b};return v&&(w=v({eventData:w,errorData:O}).eventData),e.end(w),void i(n._normalizeErrors?new m.a({errorData:O,innerError:l}):O)}var E=function(r){var o=void 0,c=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(h.b.msDiagnostics);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:h.b.msDiagnostics,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(h.b.webDavExtError);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,b=p[2];c=void 0===b?"":b,u={source:h.b.webDavExtError,code:_,message:c,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}var g=e.getResponseHeader(h.b.spoErrorCode);if(g){var v=e.getResponseHeader(h.b.spoErrorMessage);u={source:h.b.spoErrorCode,code:g,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}var y=e.getResponseHeader(h.b.subStatusCode);return y&&(u={source:h.b.subStatusCode,code:y},n.order.push(u.source),n.map[u.source]=u),{codes:n,isExpected:t}}(s),l=c.isExpected,u=c.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var f=void 0;try{f=JSON.parse(r)}catch(e){}if(f)if(f.error_description)o={code:"-1,".concat(f.error||"Unknown"),message:f.error_description},"policy_enforced"===f.error&&(l=!0);else if("string"==typeof f.error)o={message:f.error};else if(f.error&&f.error.message&&f.error.message.value){var p={source:m.b.spServiceResponse,code:f.error.code,message:"".concat(f.error.message.value),isDisplayable:!0};u.order.push(p.source),u.map[p.source]=p,o=f.error}else o=f.error||f["odata.error"]||{responseData:f};else if(r&&400===s.getStatus()){var S;S=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:S},b=(0,a.__assign)((0,a.__assign)({},b),{rawUrl:t.url,rawPayload:D})}}var I=s.getStatus(),x=s.getCorrelationId(),C=s.getResponseHeader(h.b.spGroupThrottle),O=s.getResponseHeader(h.b.webDavExtError);if(b=(0,a.__assign)((0,a.__assign)({},b),{CorrelationId:x,HttpStatus:I,GroupThrottle:C,MSCorrelationVector:s.getResponseHeader(h.b.correlationVector)}),(401===I&&O||403===I||404===I||429===I||503===I||-1===I||0===I&&y)&&(F=!1,l=!0),400===I){var w=function(e){var t,n={order:[],map:{}},a="No X-Msedge-Ref details",i=e.getResponseHeader(h.b.msEdgeRef);return i?t={source:h.b.subStatusCode,code:"Non-Empty X-Msedge-Ref details",message:i}:g.a.isActivated("44F48045-1E39-41C1-962A-7F04F8093447")&&(t={source:h.b.subStatusCode,code:a,message:a}),t&&(n.order.push(t.source),n.map[t.source]=t),{codes:n,isExpected:!1}}(s);Array.prototype.push.apply(u.order,w.codes.order),w.codes.order.forEach(function(e){u.map[e]=w.codes.map[e]}),b.rawUrl||b.rawPayload||(b=(0,a.__assign)((0,a.__assign)({},b),{rawUrl:t.url,rawPayload:D}))}(o=o||{}).codes=u,o.status=I,o.retryAfter=s.getHeaderNumberValue(h.b.retryAfter),o.authenticate=s.getResponseHeader(h.b.authenticate),o.authenticate&&(l=!0),x&&(o.correlationId=x),C&&(o.groupThrottle=C);var E=JSON.stringify(o);g.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(o.targetUrl=s.getSourceUrl());var A=o["@error.redirectUrl"],L=s.getRedirectUrl()||A;L&&(l=!0,o.redirectUrl=L);var k=u.map[m.b.spServiceResponse];k&&n._normalizeErrors&&(o.message=k.message);var M=u.order[0];M&&(p=u.map[M])&&(M===h.b.spoErrorCode&&p.message?(o.code=_.a,o.message=p.message):p.code&&(o.code=p.code)),o.code||(o.code=_.g);var P="[".concat(I,"] ").concat(o.code),T={resultType:l?d.b.ExpectedFailure:d.b.Failure,error:E,resultCode:P,extraData:b};if(v){var U=v({eventData:T,errorData:o,serverData:s}),H=U.eventData,R=U.canRetry;H&&(T=H),!0!==R&&!1!==R||(F=R),T.resultType===d.b.ExpectedFailure&&(l=!0)}var N=n._normalizeErrors?new m.a({errorData:o,isExpected:l}):o;N.codes&&N.codes&&(T.extraData.errorCodes=JSON.stringify(N.codes.map)),e.end(T),i(N)},A=s.getResponseType();A&&"text"!==A?s.parseError().then(E):E(s.getResponseText())}};!function(){var e;e=ne=R?new((0,k.a)(n._apiEvent))({url:V,name:Y,pillar:(null==R?void 0:R.pillar)?R.pillar:void 0,veto:(null==R?void 0:R.veto)?R.veto:void 0}):new n._apiEvent({url:V,name:Y});var t=j&&j.now();ie.getServerDataFromUrl({url:o,successCallback:r(e,t),failureCallback:l(e,t),uploadProgressCallback:A,additionalPostData:D,method:C,additionalHeaders:X,contentType:I,withCredentials:!x&&void 0,noRedirect:q,responseType:E,needsRequestDigest:J})}()},maxRetries:w,noTimeoutInLastRetry:T,canRetry:function(){return F},onCancel:function(e){ie&&(ie.abort(),e&&ie.dispose())}}).then(function(e){return ie&&ie.dispose(),e},function(e){return ie&&ie.dispose(),!ne.endTime&&i.c.isCanceled(e)&&ne.end({resultCode:_.b,resultType:d.b.ExpectedFailure}),i.c.reject(e)})};return x?i.c.resolve(x).then(function(e){return z({url:o,authToken:e})}):(null==G?void 0:G.authToken)?i.c.resolve(G.authToken).then(function(e){return z({url:o,authToken:e})}):K?W({apiEvent:n._apiEvent,getData:z,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:U||G&&G.webAbsoluteUrl,qosName:Y,tokenProvider:K}):(null==G?void 0:G.getAuthToken)?i.c.resolve(G.getAuthToken()).then(function(e){return z({url:o,authToken:e})}):z({url:o})},X={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?q({options:X,aadUserId:null==G?void 0:G.aadUserId,dataSyncClient:this._dataSyncClient,getData:J}):J(X)},e}();const z=V}
,1799:(e,t,n)=>{n.d(t,{a:()=>i});var a=n(0);function i(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n,i,r;return(0,a.__generator)(this,function(a){switch(a.label){case 0:n=t.subscribe(function(){e.cancel()}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e];case 2:return i=a.sent(),n(),[2,i];case 3:throw r=a.sent(),n(),r;case 4:return[2]}})})}}
,1798:(e,t,n)=>{n.d(t,{a:()=>i});var a=n(101);function i(e){var t,n=e.adjustRetries,i=e.async,r=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,d=e.delay,l=e.resetAttemptsOnRestart,u=e.shouldRestart,f=e.retries,p=0,m=new a.b(function(){t.cancel()});function _(e){u&&u()?(l&&(p=0),b()):m.complete(e)}function h(e){n&&(f=n(e)),p<f&&c(e)?(p++,r&&r(),"number"==typeof d&&i?i.setTimeout(b,d):b()):m.error(e)}function b(){(t=o()).then(_,h)}return b(),m.getPromise()}}
}]),define("shared-split-bundle~c73f4711",[],{});